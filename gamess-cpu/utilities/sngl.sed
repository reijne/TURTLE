#!/bin/sh
#
# simple double->single number conversion
# supported are 1.1d1, 1.d1 .1d1 and
#               1.1D1, 1.D1 .1D1 (as generated by e.g. Maple)
sed '
:top
   /^c[a-z]*?/{
   b skip2
   }
   /^c/{
   n
   b top
   }
   /^C/{
   n
   b top
   }
   : skip2
   /^[a-z]*?c/{
   n
   b top
   }
   /^-[a-z]*?c/{
   n
   b top
   }
   /^...... *format/{
   n
:cont
   /^..... /{
   b top
   }
   n
   b cont
   }
   s/\([-+]\{0,1\}[0-9]\{1,\}\.[0-9]\{1,\}\) \{0,\}d \{0,\}\([-+]\{0,1\}[0-9]\{1,\}\)/\1e\2/g
   s/\([-+]\{0,1\}[0-9]\{0,\}\.[0-9]\{1,\}\) \{0,\}d \{0,\}\([-+]\{0,1\}[0-9]\{1,\}\)/\1e\2/g
   s/\([-+]\{0,1\}[0-9]\{1,\}\.[0-9]\{0,\}\) \{0,\}d \{0,\}\([-+]\{0,1\}[0-9]\{1,\}\)/\1e\2/g
   s/\([-+]\{0,1\}[0-9]\{1,\}\.[0-9]\{1,\}\) \{0,\}D \{0,\}\([-+]\{0,1\}[0-9]\{1,\}\)/\1e\2/g
   s/\([-+]\{0,1\}[0-9]\{0,\}\.[0-9]\{1,\}\) \{0,\}D \{0,\}\([-+]\{0,1\}[0-9]\{1,\}\)/\1e\2/g
   s/\([-+]\{0,1\}[0-9]\{1,\}\.[0-9]\{0,\}\) \{0,\}D \{0,\}\([-+]\{0,1\}[0-9]\{1,\}\)/\1e\2/g
:wrap
/^.\{73\}/{
   h
   s/^\(.\{72\}\)\(.*\)/\1/
   p
   x
   s/^\(.\{72\}\)\(.*\)/     +\2/
   b wrap
   }'
